# Arbeitsbericht – Face in Hole (OpenCV)

---

## 13.01.2026

### Ziel
Umsetzung eines Python-Projekts mit OpenCV (cv2):  
Webcam-Bild erfassen, Gesicht erkennen und später das Gesicht in ein vorgegebenes Bild mit „Loch“ einsetzen.

### Setup / Installation
- Projekt in **PyCharm** angelegt
- Verwendung einer virtuellen Umgebung (`.venv`)
- Installierte Bibliotheken:
  - **opencv-python** (Computer Vision, Kamera, Bildverarbeitung)
  - **numpy** (Bilddaten als Arrays, Masken, Blending)

### Webcam + Gesichtserkennung
- Webcam-Stream über `cv2.VideoCapture(...)` geöffnet
- Ausgabe als Live-Preview

### Template
- Template soll an der Loch-Position **transparent** sein, damit das eingefügte Gesicht sichtbar wird
- Bereich in **Photoshop entfernt**
- Export als **PNG mit Alpha-Kanal**

### Quellen
- OpenCV (Python) – Install / Docs:  
  https://pypi.org/project/opencv-python/
- Haar-Cascades (Face Detection, OpenCV):  
  https://docs.opencv.org/4.x/d7/d8b/tutorial_py_face_detection.html
- NumPy Dokumentation:  
  https://numpy.org/doc/
- ChatGPT (OpenAI)

---

## 20.01.2026

### Ziel für heute
- Implementierung der Face-in-Hole-Funktion mit PNG-Template und Transparenz (Alpha)
- Automatische Positionierung des Gesichts im Loch
- Stabilisierung der Gesichtsdarstellung
- Analyse von Problemen bei der Gesichtserkennung

### Durchgeführte Arbeiten
- Bestehenden Webcam- und Face-Detection-Code (OpenCV, Haar Cascade) analysiert
- PNG-Template mit Alpha-Kanal in das Programm eingebunden
- Alpha-Compositing implementiert (Webcam-Bild hinter PNG)
- Verschiedene Ansätze zur Platzierung des Gesichts getestet:
  - Einfügen eines ausgeschnittenen Gesichtsbereichs in das Loch
  - Automatische Skalierung und Verschiebung des Gesichts
  - Transformation des gesamten Kamerabildes (Affine Transformation)
- Spiegelung des Kamerabildes (Selfie-Ansicht) umgesetzt
- Debug-Ausgaben zur Gesichtserkennung ergänzt

### Probleme / Schwierigkeiten
- Haar-Cascade-Gesichtserkennung arbeitet nicht stabil
- Gesicht wird nicht zuverlässig erkannt (teilweise Schulter oder Hintergrund)
- Automatische Zentrierung im Loch nicht zuverlässig
- Stark abhängig von Abstand, Licht und Kamerawinkel

### Verwendete Quellen
- OpenCV Dokumentation:  
  https://docs.opencv.org/  
  *zuletzt besucht: 20.01.2026*
- Haar Cascade Klassifikatoren:  
  https://github.com/opencv/opencv/tree/master/data/haarcascades  
  *zuletzt besucht: 20.01.2026*
- Alpha-Blending mit OpenCV:  
  https://learnopencv.com/alpha-blending-using-opencv-cpp-python/  
  *zuletzt besucht: 20.01.2026*
- ChatGPT (OpenAI)  
  Inhalte wurden eigenständig überprüft und getestet

---

## 27.01.2026

### Ziel für heute
- Baseline stabil beibehalten (Face-in-Hole funktioniert)
- Oval/Template-Loch automatisch erkennen und korrekt verwenden
- Template-Wechsel per Tastendruck implementieren
- Live-Steuerung für Zoom, Debug, Screenshot und Parameter-Ausgabe fertigstellen

### Durchgeführte Arbeiten
- Spiegelung des Webcam-Bildes dauerhaft aktiviert (`cv2.flip(frame, 1)`)
- Einfügen des Gesichts auf **elliptische Maske** umgestellt (statt Kreis)
- Loch-Erkennung automatisiert:
  - Transparentes Loch über Alpha-Kanal erkannt
  - Annäherung als Ellipse mittels `cv2.fitEllipse`
  - Fallback über Bounding-Box
- Gesichtsgröße stabilisiert:
  - Anpassung über `FACE_SCALE_X` und `FACE_SCALE_Y`
- Tastensteuerung implementiert:
  - `[ / ]`, `; / '` → Zoom
  - `d` → Debug
  - `p` → Parameter-Ausgabe
  - `s` → Screenshot
  - `ESC / q` → Beenden
- Template-Wechsel:
  - Mehrere Templates über `TEMPLATE_PATHS`
  - Wechsel per `n / b` und `1–4`
- Dateinamen festgelegt:
  - Aktuelles Template: `template_v2.png`

### Ergebnis / Stand
- Programm läuft stabil mit ovalem Loch
- Templates können während der Laufzeit gewechselt werden
- Live-Justierung der Gesichtsgröße möglich

### Verwendete Quellen
- OpenCV – Ellipse & Konturen:  
  https://docs.opencv.org/  
  *zuletzt besucht: 27.01.2026*
- OpenCV – `cv2.flip`:  
  https://docs.opencv.org/  
  *zuletzt besucht: 27.01.2026*
- ChatGPT (OpenAI)

---

## 03.02.2026

### Ziel
Probleme beim Uploaden des Projekts (GitHub) beheben

### Durchgeführte Arbeiten
- Analyse der Git-Remote-Konfiguration
- Korrektur der Repository-URL
- Einschränkung der Commits auf den eigenen Projektordner
- Upload des Python-Projekts in den vorgesehenen Ordner

### Quelle
- ChatGPT (OpenAI)  
  *zuletzt besucht: 03.02.2026*

---

## 10.02.2026

### Ziel
Die Templates sollen so angepasst werden, dass das Gesicht **nicht mehr in eine Ellipse**, sondern in eine **frei geformte Gesichtskontur des Templates** eingesetzt wird.  
Das Template bleibt fix, nur das Webcam-Bild wird skaliert.

### Durchgeführte Arbeiten
- Überarbeitung der Templates in **Photoshop**:
  - Gesichtskontur manuell freigestellt
  - Hintergrund im Gesichtsbereich vollständig transparent gemacht
  - Verwendung von:
    - Auswahlwerkzeug
    - Kanten-Verbesserung
  - Export als **PNG mit Alpha-Kanal**
- Umstellung der technischen Umsetzung:
  - Neues Python-Skript erstellt:  
    `step3_face_in_hole_mask_alpha_soft.py`
  - Loch wird nicht mehr mathematisch berechnet
  - Alpha-Kanal des PNGs definiert:
    - Wo das Gesicht sichtbar ist
    - Wie weich die Übergänge an den Rändern sind

### Ergebnis
- Deutlich natürlicher „Kopf-im-Loch“-Effekt
- Keine sichtbaren Kanten oder Hintergrundreste
- Grundlage für realistische Cartoon-Templates geschaffen
